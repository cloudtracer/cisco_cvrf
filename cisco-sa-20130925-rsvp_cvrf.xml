<?xml version="1.0" encoding="UTF-8"?>
<cvrfdoc xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.icasi.org/CVRF/schema/cvrf/1.1">
  <DocumentTitle>Cisco IOS Software Resource Reservation Protocol Interface Queue Wedge Vulnerability</DocumentTitle>
  <DocumentType>Cisco Security Advisory</DocumentType>
  <DocumentPublisher Type="Vendor">
    <ContactDetails>Emergency Support:
+1 877 228 7302 (toll-free within North America)
+1 408 525 6532 (International direct-dial)
Non-emergency Support:
Email: psirt@cisco.com
Support requests that are received via e-mail are typically acknowledged within 48 hours.</ContactDetails>
    <IssuingAuthority>Cisco product security incident response is the responsibility of the Cisco Product Security Incident Response Team (PSIRT). The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of security vulnerability information that is related to Cisco products and networks. The on-call Cisco PSIRT works 24x7 with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security issues with Cisco products and networks.
More information can be found in Cisco Security Vulnerability Policy available at http://www.cisco.com/web/about/security/psirt/security_vulnerability_policy.html</IssuingAuthority>
  </DocumentPublisher>
  <DocumentTracking>
    <Identification>
      <ID>cisco-sa-20130925-rsvp</ID>
    </Identification>
    <Status>Final</Status>
    <Version>1.1</Version>
    <RevisionHistory>
      <Revision>
        <Number>1.0</Number>
        <Date>2013-09-24T16:23:43</Date>
        <Description>Initial public release</Description>
      </Revision>
      <Revision>
        <Number>1.1</Number>
        <Date>2014-03-12T12:54:33</Date>
        <Description>Added additional details in "Affected Products" section to help determine if RSVP is enabled.</Description>
      </Revision>
    </RevisionHistory>
    <InitialReleaseDate>2013-09-25T16:00:00</InitialReleaseDate>
    <CurrentReleaseDate>2014-03-12T12:54:33</CurrentReleaseDate>
    <Generator>
      <Engine>TVCE</Engine>
    </Generator>
  </DocumentTracking>
  <DocumentNotes>
    <Note Title="Summary" Type="General" Ordinal="1">A vulnerability in the Resource Reservation Protocol (RSVP) feature of Cisco IOS Software and Cisco IOS XE Software could allow an unauthenticated, remote attacker to trigger an interface queue wedge on the affected device.



The vulnerability is due to improper parsing of UDP RSVP packets. An attacker could exploit this vulnerability by sending UDP port 1698 RSVP packets to the vulnerable device. An exploit could cause Cisco IOS Software and Cisco IOS XE Software to incorrectly process incoming packets, resulting in an interface queue wedge, which can lead to loss of connectivity, loss of routing protocol adjacency, and other denial of service (DoS) conditions.

 

Cisco has released software updates that address this vulnerability.



Workarounds that mitigate this vulnerability are available.



This advisory is available at the following link: 

http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20130925-rsvp["http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20130925-rsvp"]

Note: The September 25, 2013, Cisco IOS Software Security Advisory bundled publication includes eight Cisco Security Advisories. All advisories address vulnerabilities in Cisco IOS Software. Each Cisco IOS Software Security Advisory lists the Cisco IOS Software releases that correct the vulnerability or vulnerabilities detailed in the advisory as well as the Cisco IOS Software releases that correct all Cisco IOS Software vulnerabilities in the September 2013 bundled publication. 

Individual publication links are in "Cisco Event Response: Semiannual Cisco IOS Software Security Advisory Bundled Publication" at the following link: 

http://www.cisco.com/web/about/security/intelligence/Cisco_ERP_sep13.html["http://www.cisco.com/web/about/security/intelligence/Cisco_ERP_sep13.html"]
</Note>
  </DocumentNotes>
  <DocumentReferences>
    <Reference Type="Self">
      <URL>http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20130925-rsvp</URL>
      <Description>Cisco IOS Software Resource Reservation Protocol Interface Queue Wedge Vulnerability</Description>
    </Reference>
    <Reference>
      <URL>http://tools.cisco.com/security/center/content/CiscoSecurityBundle/cisco-sa-20130925-bundle</URL>
      <Description>Summary of Semiannual Cisco IOS Software Security Advisory Bundled Publication, September 25, 2013</Description>
    </Reference>
    <Reference>
      <URL>http://tools.cisco.com/security/center/viewAMBAlert.x?alertId=30053</URL>
      <Description>Identifying and Mitigating Exploitation of Cisco IOS Software RSVP Interface Queue Wedge Vulnerability</Description>
    </Reference>
    <Reference>
      <URL>http://tools.cisco.com/security/center/content/CiscoSecurityBundle/cisco-sa-20130925-bundle</URL>
      <Description>Summary of Semiannual Cisco IOS Software Security Advisory Bundled Publication, September 25, 2013</Description>
    </Reference>
    <Reference>
      <URL>http://tools.cisco.com/security/center/viewAMBAlert.x?alertId=30053</URL>
      <Description>Identifying and Mitigating Exploitation of Cisco IOS Software RSVP Interface Queue Wedge Vulnerability</Description>
    </Reference>
  </DocumentReferences>
  <ProductTree xmlns="http://www.icasi.org/CVRF/schema/prod/1.1">
    <FullProductName ProductID="CVRFPID-106499">Cisco IOS 15.0(1)M</FullProductName>
    <FullProductName ProductID="CVRFPID-99645">Cisco IOS 15.0(1)M1</FullProductName>
    <FullProductName ProductID="CVRFPID-105005">Cisco IOS 15.0(1)M4</FullProductName>
    <FullProductName ProductID="CVRFPID-105790">Cisco IOS 15.0(1)SY</FullProductName>
    <FullProductName ProductID="CVRFPID-112823">Cisco IOS 15.0(1)SY1</FullProductName>
    <FullProductName ProductID="CVRFPID-183657">Cisco IOS 15.0(1)SY3</FullProductName>
    <FullProductName ProductID="CVRFPID-107048">Cisco IOS 15.0(1)XA</FullProductName>
    <FullProductName ProductID="CVRFPID-104165">Cisco IOS 15.0(1)XA2</FullProductName>
    <FullProductName ProductID="CVRFPID-106740">Cisco IOS 15.0(1)XA3</FullProductName>
    <FullProductName ProductID="CVRFPID-105426">Cisco IOS 15.0(1)XA4</FullProductName>
    <FullProductName ProductID="CVRFPID-107191">Cisco IOS 15.0(1)XA5</FullProductName>
    <FullProductName ProductID="CVRFPID-107856">Cisco IOS 15.1(4)M</FullProductName>
    <FullProductName ProductID="CVRFPID-107853">Cisco IOS 15.1(1)S</FullProductName>
    <FullProductName ProductID="CVRFPID-107854">Cisco IOS 15.1(1)S1</FullProductName>
    <FullProductName ProductID="CVRFPID-108865">Cisco IOS 15.1(2)S1</FullProductName>
    <FullProductName ProductID="CVRFPID-110090">Cisco IOS 15.1(2)S2</FullProductName>
    <FullProductName ProductID="CVRFPID-107855">Cisco IOS 15.1(3)S</FullProductName>
    <FullProductName ProductID="CVRFPID-111161">Cisco IOS 15.1(3)S0a</FullProductName>
    <FullProductName ProductID="CVRFPID-111026">Cisco IOS 15.1(3)S1</FullProductName>
    <FullProductName ProductID="CVRFPID-111552">Cisco IOS 15.1(3)S2</FullProductName>
    <FullProductName ProductID="CVRFPID-111558">Cisco IOS 15.1(3)S3</FullProductName>
    <FullProductName ProductID="CVRFPID-111553">Cisco IOS 15.1(3)S4</FullProductName>
    <FullProductName ProductID="CVRFPID-184123">Cisco IOS 15.1(3)S5</FullProductName>
    <FullProductName ProductID="CVRFPID-112489">Cisco IOS 15.1(1)SY</FullProductName>
    <FullProductName ProductID="CVRFPID-115285">Cisco IOS 15.1(1)SY1</FullProductName>
    <FullProductName ProductID="CVRFPID-107433">Cisco IOS 15.1(1)T</FullProductName>
    <FullProductName ProductID="CVRFPID-105178">Cisco IOS 15.1(1)T1</FullProductName>
    <FullProductName ProductID="CVRFPID-106988">Cisco IOS 15.1(1)T2</FullProductName>
    <FullProductName ProductID="CVRFPID-100214">Cisco IOS 15.1(2)T</FullProductName>
    <FullProductName ProductID="CVRFPID-106078">Cisco IOS 15.1(2)T0a</FullProductName>
    <FullProductName ProductID="CVRFPID-107691">Cisco IOS 15.1(2)T1</FullProductName>
    <FullProductName ProductID="CVRFPID-107626">Cisco IOS 15.1(2)T2</FullProductName>
    <FullProductName ProductID="CVRFPID-107123">Cisco IOS 15.1(2)T2a</FullProductName>
    <FullProductName ProductID="CVRFPID-107057">Cisco IOS 15.1(3)T</FullProductName>
    <FullProductName ProductID="CVRFPID-214072">Cisco IOS 15.2(4m)E1</FullProductName>
    <FullProductName ProductID="CVRFPID-107859">Cisco IOS 15.2(1)S</FullProductName>
    <FullProductName ProductID="CVRFPID-111551">Cisco IOS 15.2(1)S1</FullProductName>
    <FullProductName ProductID="CVRFPID-114168">Cisco IOS 15.2(1)S2</FullProductName>
    <FullProductName ProductID="CVRFPID-107861">Cisco IOS 15.2(2)S</FullProductName>
    <FullProductName ProductID="CVRFPID-114419">Cisco IOS 15.2(2)S1</FullProductName>
    <FullProductName ProductID="CVRFPID-115687">Cisco IOS 15.2(2)S2</FullProductName>
    <FullProductName ProductID="CVRFPID-112424">Cisco IOS 15.2(4)S</FullProductName>
    <FullProductName ProductID="CVRFPID-183813">Cisco IOS 15.2(4)S1</FullProductName>
    <FullProductName ProductID="CVRFPID-183837">Cisco IOS 15.2(4)S2</FullProductName>
    <FullProductName ProductID="CVRFPID-183839">Cisco IOS 15.2(4)S3</FullProductName>
    <FullProductName ProductID="CVRFPID-107862">Cisco IOS 15.2(2)T</FullProductName>
    <FullProductName ProductID="CVRFPID-113970">Cisco IOS 15.3(1)S</FullProductName>
    <FullProductName ProductID="CVRFPID-188008">Cisco IOS 15.3(1)S1</FullProductName>
    <FullProductName ProductID="CVRFPID-187962">Cisco IOS 15.3(1)S2</FullProductName>
    <FullProductName ProductID="CVRFPID-103851">Cisco IOS 15.3(1)T</FullProductName>
    <FullProductName ProductID="CVRFPID-187231">Cisco IOS 15.3(1)T1</FullProductName>
    <FullProductName ProductID="CVRFPID-111950">Cisco IOS XE Software 3.2S 3.2.0S</FullProductName>
    <FullProductName ProductID="CVRFPID-112449">Cisco IOS XE Software 3.2S 3.2.1S</FullProductName>
    <FullProductName ProductID="CVRFPID-112450">Cisco IOS XE Software 3.2S 3.2.2S</FullProductName>
    <FullProductName ProductID="CVRFPID-111952">Cisco IOS XE Software 3.3S 3.3.0S</FullProductName>
    <FullProductName ProductID="CVRFPID-112451">Cisco IOS XE Software 3.3S 3.3.1S</FullProductName>
    <FullProductName ProductID="CVRFPID-112452">Cisco IOS XE Software 3.3S 3.3.2S</FullProductName>
    <FullProductName ProductID="CVRFPID-111954">Cisco IOS XE Software 3.4S 3.4.0S</FullProductName>
    <FullProductName ProductID="CVRFPID-112453">Cisco IOS XE Software 3.4S 3.4.1S</FullProductName>
    <FullProductName ProductID="CVRFPID-184469">Cisco IOS XE Software 3.4S 3.4.2S</FullProductName>
    <FullProductName ProductID="CVRFPID-184470">Cisco IOS XE Software 3.4S 3.4.3S</FullProductName>
    <FullProductName ProductID="CVRFPID-184471">Cisco IOS XE Software 3.4S 3.4.4S</FullProductName>
    <FullProductName ProductID="CVRFPID-194728">Cisco IOS XE Software 3.4S 3.4.5S</FullProductName>
    <FullProductName ProductID="CVRFPID-184472">Cisco IOS XE Software 3.5S 3.5.0S</FullProductName>
    <FullProductName ProductID="CVRFPID-184473">Cisco IOS XE Software 3.5S 3.5.1S</FullProductName>
    <FullProductName ProductID="CVRFPID-184474">Cisco IOS XE Software 3.5S 3.5.2S</FullProductName>
    <FullProductName ProductID="CVRFPID-184475">Cisco IOS XE Software 3.6S 3.6.0S</FullProductName>
    <FullProductName ProductID="CVRFPID-184476">Cisco IOS XE Software 3.6S 3.6.1S</FullProductName>
    <FullProductName ProductID="CVRFPID-184477">Cisco IOS XE Software 3.6S 3.6.2S</FullProductName>
    <FullProductName ProductID="CVRFPID-184480">Cisco IOS XE Software 3.7S 3.7.0S</FullProductName>
    <FullProductName ProductID="CVRFPID-184481">Cisco IOS XE Software 3.7S 3.7.1S</FullProductName>
    <FullProductName ProductID="CVRFPID-194730">Cisco IOS XE Software 3.7S 3.7.2S</FullProductName>
    <FullProductName ProductID="CVRFPID-194731">Cisco IOS XE Software 3.7S 3.7.3S</FullProductName>
    <FullProductName ProductID="CVRFPID-194735">Cisco IOS XE Software 3.8S 3.8.0S</FullProductName>
    <FullProductName ProductID="CVRFPID-194736">Cisco IOS XE Software 3.8S 3.8.1S</FullProductName>
    <FullProductName ProductID="CVRFPID-194737">Cisco IOS XE Software 3.8S 3.8.2S</FullProductName>
  </ProductTree>
  <Vulnerability Ordinal="1" xmlns="http://www.icasi.org/CVRF/schema/vuln/1.1">
    <Title>Cisco IOS Software RSVP Interface Queue Wedge Vulnerability</Title>
    <ID SystemName="Cisco Bug ID">CSCuf17023</ID>
    <Notes>
      <Note Title="Summary" Type="Summary" Ordinal="1">A vulnerability in the RSVP feature of Cisco IOS Software and Cisco IOS XE Software could allow an unauthenticated, remote attacker to trigger an interface queue wedge on the affected device.



The vulnerability is due to improper parsing of UDP RSVP packets. An attacker could exploit this vulnerability by sending UDP RSVP packets to the vulnerable device. An exploit could cause Cisco IOS Software and Cisco IOS XE Software to incorrectly process incoming packets, resulting in an interface queue wedge, which can lead to loss of connectivity, loss of routing protocol adjacency, and other DoS conditions.
</Note>
      <Note Title="Cisco Bug IDs" Type="Other" Ordinal="3">CSCuf17023</Note>
    </Notes>
    <CVE>CVE-2013-5478</CVE>
    <ProductStatuses>
      <Status Type="Known Affected">
        <ProductID>CVRFPID-99645</ProductID>
        <ProductID>CVRFPID-100214</ProductID>
        <ProductID>CVRFPID-103851</ProductID>
        <ProductID>CVRFPID-104165</ProductID>
        <ProductID>CVRFPID-105005</ProductID>
        <ProductID>CVRFPID-105178</ProductID>
        <ProductID>CVRFPID-105426</ProductID>
        <ProductID>CVRFPID-105790</ProductID>
        <ProductID>CVRFPID-106078</ProductID>
        <ProductID>CVRFPID-106499</ProductID>
        <ProductID>CVRFPID-106740</ProductID>
        <ProductID>CVRFPID-106988</ProductID>
        <ProductID>CVRFPID-107048</ProductID>
        <ProductID>CVRFPID-107057</ProductID>
        <ProductID>CVRFPID-107123</ProductID>
        <ProductID>CVRFPID-107191</ProductID>
        <ProductID>CVRFPID-107433</ProductID>
        <ProductID>CVRFPID-107626</ProductID>
        <ProductID>CVRFPID-107691</ProductID>
        <ProductID>CVRFPID-107853</ProductID>
        <ProductID>CVRFPID-107854</ProductID>
        <ProductID>CVRFPID-107855</ProductID>
        <ProductID>CVRFPID-107856</ProductID>
        <ProductID>CVRFPID-107859</ProductID>
        <ProductID>CVRFPID-107861</ProductID>
        <ProductID>CVRFPID-107862</ProductID>
        <ProductID>CVRFPID-108865</ProductID>
        <ProductID>CVRFPID-110090</ProductID>
        <ProductID>CVRFPID-111026</ProductID>
        <ProductID>CVRFPID-111161</ProductID>
        <ProductID>CVRFPID-111551</ProductID>
        <ProductID>CVRFPID-111552</ProductID>
        <ProductID>CVRFPID-111553</ProductID>
        <ProductID>CVRFPID-111558</ProductID>
        <ProductID>CVRFPID-112424</ProductID>
        <ProductID>CVRFPID-112489</ProductID>
        <ProductID>CVRFPID-112823</ProductID>
        <ProductID>CVRFPID-113970</ProductID>
        <ProductID>CVRFPID-114168</ProductID>
        <ProductID>CVRFPID-114419</ProductID>
        <ProductID>CVRFPID-115285</ProductID>
        <ProductID>CVRFPID-115687</ProductID>
        <ProductID>CVRFPID-183657</ProductID>
        <ProductID>CVRFPID-183813</ProductID>
        <ProductID>CVRFPID-183837</ProductID>
        <ProductID>CVRFPID-183839</ProductID>
        <ProductID>CVRFPID-184123</ProductID>
        <ProductID>CVRFPID-187231</ProductID>
        <ProductID>CVRFPID-187962</ProductID>
        <ProductID>CVRFPID-188008</ProductID>
        <ProductID>CVRFPID-214072</ProductID>
        <ProductID>CVRFPID-111950</ProductID>
        <ProductID>CVRFPID-111952</ProductID>
        <ProductID>CVRFPID-111954</ProductID>
        <ProductID>CVRFPID-112449</ProductID>
        <ProductID>CVRFPID-112450</ProductID>
        <ProductID>CVRFPID-112451</ProductID>
        <ProductID>CVRFPID-112452</ProductID>
        <ProductID>CVRFPID-112453</ProductID>
        <ProductID>CVRFPID-184469</ProductID>
        <ProductID>CVRFPID-184470</ProductID>
        <ProductID>CVRFPID-184471</ProductID>
        <ProductID>CVRFPID-184472</ProductID>
        <ProductID>CVRFPID-184473</ProductID>
        <ProductID>CVRFPID-184474</ProductID>
        <ProductID>CVRFPID-184475</ProductID>
        <ProductID>CVRFPID-184476</ProductID>
        <ProductID>CVRFPID-184477</ProductID>
        <ProductID>CVRFPID-184480</ProductID>
        <ProductID>CVRFPID-184481</ProductID>
        <ProductID>CVRFPID-194728</ProductID>
        <ProductID>CVRFPID-194730</ProductID>
        <ProductID>CVRFPID-194731</ProductID>
        <ProductID>CVRFPID-194735</ProductID>
        <ProductID>CVRFPID-194736</ProductID>
        <ProductID>CVRFPID-194737</ProductID>
      </Status>
    </ProductStatuses>
    <CVSSScoreSets>
      <ScoreSet>
        <BaseScore>7.8</BaseScore>
        <TemporalScore>6.4</TemporalScore>
        <Vector>AV:N/AC:L/Au:N/C:N/I:N/A:C/E:F/RL:OF/RC:C</Vector>
      </ScoreSet>
    </CVSSScoreSets>
    <Remediations>
      <Remediation Type="Workaround">
        <Description>The following identification mechanisms exist for this vulnerability:



Embedded Event Manager



A Cisco IOS Embedded Event Manager (EEM) policy that is based on Tool Command Language (Tcl) can be used on vulnerable Cisco IOS devices to identify and detect an interface queue wedge that is caused by this vulnerability. The policy allows administrators to monitor the interfaces for Cisco IOS device and detect when the interface input queues are full. When Cisco IOS EEM detects potential exploitation of this vulnerability, the policy can trigger a response by sending an alert to the network administrator, who could then decide to implement an upgrade, implement suitable mitigations or reload the device to clear the input queue.



The Tcl script is available for download at the "Cisco Beyond: Embedded Event Manager (EEM) Scripting Community" at the following link: https://supportforums.cisco.com/docs/DOC-19337["https://supportforums.cisco.com/docs/DOC-19337"]



Also see the Cisco Security Blog "Cisco IOS Queue Wedges Explained" at the following link: http://blogs.cisco.com/security/cisco_ios_queue_wedges_explained/["http://blogs.cisco.com/security/cisco_ios_queue_wedges_explained/"]



The following mitigations exist for this vulnerability:



IP RSVP Listener



It is possible to mitigate this vulnerability under affected configurations by applying the global configuration command ip rsvp listener vrf vrf-name ip-address udp 1698 announce, where the IP address is one that does not exist on the device or in the routing tables.



Infrastructure Access Control Lists (iACL) and Unicast Reverse Path Forwarding (uRPF) 



Because the feature in this vulnerability utilizes UDP as a transport, it is possible to spoof the sender's IP address, which may defeat ACLs that permit communication to these ports from trusted IP addresses. In addition to ACLs, administrators should enable uRPF, a security feature of Cisco IOS Software that verifies the reachability of the source address in packets being forwarded. The combination of these two technologies offers a stronger migration than iACLs alone.



Although it is often difficult to block traffic that transits a network, it is possible to identify traffic that should never be allowed to target infrastructure devices and block that traffic at the border of networks. Infrastructure ACLs (iACLs) are a network security best practice and should be considered as a long-term addition to good network security as well as a workaround for this specific vulnerability. The iACL example below should be included as part of the deployed infrastructure access-list, which will help protect all devices with IP addresses in the infrastructure IP address range: 

!---!--- Feature: RSVP over UDP!---

access-list 150 permit udp TRUSTED_SOURCE_ADDRESSES WILDCARD 
    INFRASTRUCTURE_ADDRESSES WILDCARD eq 1698

!--- Deny RSVP over UDP traffic from all other sources destined !--- to infrastructure addresses.

access-list 150 deny udp any 
    INFRASTRUCTURE_ADDRESSES WILDCARD eq 1698

!--- Permit/deny all other Layer 3 and Layer 4 traffic in !--- accordance with existing security policies and !--- configurations. Permit all other traffic to transit the!--- device.

access-list 150 permit ip any any

!--- Apply access-list to all interfaces (only one example!--- shown)

interface fastEthernet 2/0
 ip access-group 150 in
The white paper entitled "Protecting Your Core: Infrastructure Protection Access Control Lists" presents guidelines and recommended deployment techniques for infrastructure protection access lists and is available at the following link http://www.cisco.com/en/US/tech/tk648/tk361/technologies_white_paper09186a00801a1a55.shtml["http://www.cisco.com/en/US/tech/tk648/tk361/technologies_white_paper09186a00801a1a55.shtml"] 



Control Plane Policing 



Warning: Because the feature in this vulnerability utilizes UDP as a transport, it is possible to spoof the sender's IP address, which may defeat ACLs that permit communication to these ports from trusted IP addresses. Unicast RPF should be considered to be used in conjunction to offer a better mitigation solution. 



Control Plane Policing (CoPP) can be used to block untrusted UDP traffic to the device. Cisco IOS software releases 12.0S, 12.2SX, 12.2S, 12.3T, 12.4, and 12.4T support the CoPP feature. CoPP can be configured on a device to help protect the management and control planes and minimize the risk and effectiveness of direct infrastructure attacks by explicitly permitting only authorized traffic that is sent to infrastructure devices in accordance with existing security policies and configurations. The CoPP example below should be included as part of the deployed CoPP, which will help protect all devices with IP addresses in the infrastructure IP address range. 
!--- Feature: RSVP over UDP

access-list 150 deny udp TRUSTED_SOURCE_ADDRESSES WILDCARD
     any eq 1698

!--- Deny RSVP over UDP traffic from all other sources destined !--- to the device control plane.

access-list 150 permit udp any any eq 1698

!--- Permit (Police or Drop)/Deny (Allow) all other Layer3 and !--- Layer4 traffic in accordance with existing security policies !--- and configurations for traffic that is authorized to be sent !--- to infrastructure devices !--- Create a Class-Map for traffic to be policed by!--- the CoPP feature

class-map match-all drop-udp-class
 match access-group 150

!--- Create a Policy-Map that will be applied to the !--- Control-Plane of the device.

policy-map drop-udp-traffic
 class drop-udp-class
  drop

!--- Apply the Policy-Map to the !--- Control-Plane of the device

control-plane
 service-policy input drop-udp-traffic
In the above CoPP example, the access control list entries (ACEs) that match the potential exploit packets with the "permit" action result in these packets being discarded by the policy-map "drop" function, while packets that match the "deny" action (not shown) are not affected by the policy-map drop function. Please note that the policy-map syntax is different in the 12.2S and 12.0S Cisco IOS software trains: 
policy-map drop-udp-traffic
class drop-udp-class
police 32000 1500 1500 conform-action drop exceed-action drop
Additional information on the configuration and use of the CoPP feature can be found in the documents, "Control Plane Policing Implementation Best Practices" and "Control Plane Policing" at the following links: http://www.cisco.com/web/about/security/intelligence/coppwp_gs.html["http://www.cisco.com/web/about/security/intelligence/coppwp_gs.html"] and http://www.cisco.com/en/US/docs/ios/12_4t/12_4t4/htcpp.html["http://www.cisco.com/en/US/docs/ios/12_4t/12_4t4/htcpp.html"]</Description>
      </Remediation>
    </Remediations>
    <References>
      <Reference Type="Self">
        <URL>http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20130925-rsvp</URL>
        <Description>Cisco IOS Software Resource Reservation Protocol Interface Queue Wedge Vulnerability</Description>
      </Reference>
    </References>
  </Vulnerability>
</cvrfdoc>