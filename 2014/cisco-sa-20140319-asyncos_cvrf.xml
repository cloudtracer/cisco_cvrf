<?xml version="1.0" encoding="UTF-8"?>
<cvrfdoc xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.icasi.org/CVRF/schema/cvrf/1.1">
  <DocumentTitle>Cisco AsyncOS Software Code Execution Vulnerability</DocumentTitle>
  <DocumentType>Cisco Security Advisory</DocumentType>
  <DocumentPublisher Type="Vendor">
    <ContactDetails>Emergency Support:
+1 877 228 7302 (toll-free within North America)
+1 408 525 6532 (International direct-dial)
Non-emergency Support:
Email: psirt@cisco.com
Support requests that are received via e-mail are typically acknowledged within 48 hours.</ContactDetails>
    <IssuingAuthority>Cisco product security incident response is the responsibility of the Cisco Product Security Incident Response Team (PSIRT). The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of security vulnerability information that is related to Cisco products and networks. The on-call Cisco PSIRT works 24x7 with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security issues with Cisco products and networks.
More information can be found in Cisco Security Vulnerability Policy available at http://www.cisco.com/web/about/security/psirt/security_vulnerability_policy.html</IssuingAuthority>
  </DocumentPublisher>
  <DocumentTracking>
    <Identification>
      <ID>cisco-sa-20140319-asyncos</ID>
    </Identification>
    <Status>Final</Status>
    <Version>1.0</Version>
    <RevisionHistory>
      <Revision>
        <Number>1.0</Number>
        <Date>2014-03-19T15:41:33</Date>
        <Description>Initial public release</Description>
      </Revision>
    </RevisionHistory>
    <InitialReleaseDate>2014-03-19T16:00:00</InitialReleaseDate>
    <CurrentReleaseDate>2014-03-19T15:41:33</CurrentReleaseDate>
    <Generator>
      <Engine>TVCE</Engine>
    </Generator>
  </DocumentTracking>
  <DocumentNotes>
    <Note Title="Summary" Type="General" Ordinal="1">Cisco AsyncOS Software for Email Security Appliance (ESA) and Cisco Content Security Management Appliance (SMA) contain a vulnerability that could allow an authenticated remote attacker to execute arbitrary code with the privileges of the root user.



Cisco has released software updates that address this vulnerability. Workarounds that mitigate this vulnerability are not available.
This advisory is available at the following link:

http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20140319-asyncos["http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20140319-asyncos"]</Note>
  </DocumentNotes>
  <DocumentReferences>
    <Reference Type="Self">
      <URL>http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20140319-asyncos</URL>
      <Description>Cisco AsyncOS Software Code Execution Vulnerability</Description>
    </Reference>
    <Reference>
      <URL>http://tools.cisco.com/security/center/viewAlert.x?alertId=33309</URL>
      <Description>Cisco AsyncOS Software SLBL Code Execution Vulnerability</Description>
    </Reference>
    <Reference>
      <URL>http://tools.cisco.com/security/center/viewAlert.x?alertId=33309</URL>
      <Description>Cisco AsyncOS Software SLBL Code Execution Vulnerability</Description>
    </Reference>
  </DocumentReferences>
  <ProductTree xmlns="http://www.icasi.org/CVRF/schema/prod/1.1">
    <FullProductName ProductID="CVRFPID-189799">Cisco Email Security Appliance (ESA) 7.1.0</FullProductName>
    <FullProductName ProductID="CVRFPID-189960">Cisco Email Security Appliance (ESA) 7.1.1</FullProductName>
    <FullProductName ProductID="CVRFPID-189961">Cisco Email Security Appliance (ESA) 7.1.2</FullProductName>
    <FullProductName ProductID="CVRFPID-189962">Cisco Email Security Appliance (ESA) 7.1.3</FullProductName>
    <FullProductName ProductID="CVRFPID-189963">Cisco Email Security Appliance (ESA) 7.1.4</FullProductName>
    <FullProductName ProductID="CVRFPID-189964">Cisco Email Security Appliance (ESA) 7.1.5</FullProductName>
    <FullProductName ProductID="CVRFPID-189801">Cisco Email Security Appliance (ESA) 7.3.0</FullProductName>
    <FullProductName ProductID="CVRFPID-190773">Cisco Email Security Appliance (ESA) 7.3.1</FullProductName>
    <FullProductName ProductID="CVRFPID-190774">Cisco Email Security Appliance (ESA) 7.3.2</FullProductName>
    <FullProductName ProductID="CVRFPID-189803">Cisco Email Security Appliance (ESA) 7.5.0</FullProductName>
    <FullProductName ProductID="CVRFPID-189965">Cisco Email Security Appliance (ESA) 7.5.1</FullProductName>
    <FullProductName ProductID="CVRFPID-189966">Cisco Email Security Appliance (ESA) 7.5.2</FullProductName>
    <FullProductName ProductID="CVRFPID-189805">Cisco Email Security Appliance (ESA) 7.6.0</FullProductName>
    <FullProductName ProductID="CVRFPID-189967">Cisco Email Security Appliance (ESA) 7.6.1-000</FullProductName>
    <FullProductName ProductID="CVRFPID-189968">Cisco Email Security Appliance (ESA) 7.6.2</FullProductName>
    <FullProductName ProductID="CVRFPID-189807">Cisco Email Security Appliance (ESA) 7.8.0</FullProductName>
    <FullProductName ProductID="CVRFPID-189809">Cisco Email Security Appliance (ESA) 8.0 Base</FullProductName>
    <FullProductName ProductID="CVRFPID-189811">Cisco Content Security Management Appliance (SMA) 7.2.0</FullProductName>
    <FullProductName ProductID="CVRFPID-189958">Cisco Content Security Management Appliance (SMA) 7.2.1</FullProductName>
    <FullProductName ProductID="CVRFPID-189959">Cisco Content Security Management Appliance (SMA) 7.2.2</FullProductName>
    <FullProductName ProductID="CVRFPID-189813">Cisco Content Security Management Appliance (SMA) 7.7.0</FullProductName>
    <FullProductName ProductID="CVRFPID-189957">Cisco Content Security Management Appliance (SMA) 7.7.1</FullProductName>
    <FullProductName ProductID="CVRFPID-198228">Cisco Content Security Management Appliance (SMA) 7.8.0</FullProductName>
    <FullProductName ProductID="CVRFPID-189817">Cisco Content Security Management Appliance (SMA) 8.0.0</FullProductName>
    <FullProductName ProductID="CVRFPID-189819">Cisco Content Security Management Appliance (SMA) 8.1.0</FullProductName>
  </ProductTree>
  <Vulnerability Ordinal="1" xmlns="http://www.icasi.org/CVRF/schema/vuln/1.1">
    <Title>Cisco AsyncOS Software SLBL Code Execution Vulnerability</Title>
    <ID SystemName="Cisco Bug ID">CSCug79377</ID>
    <Notes>
      <Note Title="Summary" Type="Summary" Ordinal="1">A vulnerability in the End User Safelist/Blocklist (SLBL)
function of Cisco AsyncOS Software for Cisco Email Security Appliance and Cisco Content Security Management Appliance could allow an authenticated, remote attacker to execute arbitrary code on an affected system.



The
vulnerability is due to insufficient validation of the SLBL database file.
An attacker could exploit this vulnerability by substituting a valid
SLBL database file with a tampered file. The tampered file could contain
shell code that would be executed by the affected system when a specific
event is triggered (for example, when a new email is received that
triggers the SLBL check). To exploit this vulnerability, the attacker must have the FTP and SLBL services enabled, at least temporarily, and have valid credentials to upload the tampered
SLBL database file via FTP. 



An exploit could allow the attacker to execute
arbitrary code on the affected system with the privileges of the root
user.</Note>
      <Note Title="Cisco Bug IDs" Type="Other" Ordinal="3">CSCug79377,CSCug80118</Note>
    </Notes>
    <CVE>CVE-2014-2119</CVE>
    <ProductStatuses>
      <Status Type="Known Affected">
        <ProductID>CVRFPID-189799</ProductID>
        <ProductID>CVRFPID-189801</ProductID>
        <ProductID>CVRFPID-189803</ProductID>
        <ProductID>CVRFPID-189805</ProductID>
        <ProductID>CVRFPID-189807</ProductID>
        <ProductID>CVRFPID-189809</ProductID>
        <ProductID>CVRFPID-189960</ProductID>
        <ProductID>CVRFPID-189961</ProductID>
        <ProductID>CVRFPID-189962</ProductID>
        <ProductID>CVRFPID-189963</ProductID>
        <ProductID>CVRFPID-189964</ProductID>
        <ProductID>CVRFPID-189965</ProductID>
        <ProductID>CVRFPID-189966</ProductID>
        <ProductID>CVRFPID-189967</ProductID>
        <ProductID>CVRFPID-189968</ProductID>
        <ProductID>CVRFPID-190773</ProductID>
        <ProductID>CVRFPID-190774</ProductID>
        <ProductID>CVRFPID-189811</ProductID>
        <ProductID>CVRFPID-189813</ProductID>
        <ProductID>CVRFPID-189817</ProductID>
        <ProductID>CVRFPID-189819</ProductID>
        <ProductID>CVRFPID-189957</ProductID>
        <ProductID>CVRFPID-189958</ProductID>
        <ProductID>CVRFPID-189959</ProductID>
        <ProductID>CVRFPID-198228</ProductID>
      </Status>
    </ProductStatuses>
    <CVSSScoreSets>
      <ScoreSet>
        <BaseScore>8.5</BaseScore>
        <TemporalScore>7.0</TemporalScore>
        <Vector>AV:N/AC:M/Au:S/C:C/I:C/A:C/E:F/RL:OF/RC:C</Vector>
      </ScoreSet>
    </CVSSScoreSets>
    <Remediations>
      <Remediation Type="Workaround">
        <Description>There are no workarounds that mitigate this vulnerability. Disabling the FTP service will reduce the exposure to this vulnerability because it could prevent replacing the SLBL database file with a malicious one.



To disable the FTP service via the GUI, navigate to Network &gt; IP Interfaces. For each interfaces click on the interface name and uncheck FTP check box in the services area of the Edit window.

Alternatively, the CLI can be used. To disable the FTP service via the CLI, use the interfaceconfig command and choose to EDIT the interfaces configuration. When prompted, type N to disable the FTP service and commit the changes using the commit command. The following example shows how to disable the FTP service on Cisco ESA:






ciscoesa&gt; interfaceconfig


Currently configured interfaces:
1. Management (192.168.42.42/24 on Management: ciscoesa)

Choose the operation you want to perform:
- NEW - Create a new interface.
- EDIT - Modify an interface.
- GROUPS - Define interface groups.
- DELETE - Remove an interface.
[]&gt; edit

Enter the number of the interface you wish to edit.
[]&gt; 1

IP interface name (Ex: "InternalNet"):
[Management]&gt; 

Would you like to configure an IPv4 address for this interface (y/n)? [Y]&gt; 

IPv4 Address (Ex: 192.168.1.2 ):
[192.168.42.42]&gt; 

Netmask (Ex: "24", "255.255.255.0" or "0xffffff00"):
[24]&gt; 

Would you like to configure an IPv6 address for this interface (y/n)? [N]&gt; 

Ethernet interface:
1. Data 1
2. Data 2
3. Management
[3]&gt; 

Hostname:
[ciscoesa]&gt; 

Do you want to enable Telnet on this interface? [N]&gt; 

Do you want to enable SSH on this interface? [Y]&gt; 

Which port do you want to use for SSH?
[22]&gt; 

Do you want to enable FTP on this interface? [Y]&gt;  (Set option to 'N') this will disable the service once change has been committed.

Which port do you want to use for FTP?   
[21]&gt; 

Do you want to enable Cluster Communication Service on this interface? [N]&gt; 

Do you want to enable HTTP on this interface? [Y]&gt; 

Which port do you want to use for HTTP?
[80]&gt; 

Do you want to enable HTTPS on this interface? [Y]&gt; 

Which port do you want to use for HTTPS?
[443]&gt; 

Do you want to enable Spam Quarantine HTTP on this interface? [Y]&gt; 

Which port do you want to use for Spam Quarantine HTTP?
[82]&gt; 

Do you want to enable Spam Quarantine HTTPS on this interface? [Y]&gt; 

Which port do you want to use for Spam Quarantine HTTPS?
[83]&gt; 

Do you want to enable RSA Enterprise Manager Integration on this interface? [N]&gt; 

The "Demo" certificate is currently configured. You may use "Demo", but this will not be secure. To assure privacy, run "certconfig" first.

Both HTTP and HTTPS are enabled for this interface, should HTTP requests redirect to the secure service? [Y]&gt; 

Both Spam Quarantine HTTP and Spam Quarantine HTTPS are enabled for this interface, should Spam Quarantine HTTP requests redirect to the secure service? [Y]&gt; 

Do you want Management as the default interface for your Spam Quarantine? [N]&gt; 


Currently configured interfaces:
1. Management (192.168.42.42/24 on Management: ironport.example.com)

Choose the operation you want to perform:
- NEW - Create a new interface.
- EDIT - Modify an interface.
- GROUPS - Define interface groups.
- DELETE - Remove an interface.
[]&gt; 

ciscoese&gt; commit

Please enter some comments describing your changes:
[]&gt; disabled FTP




In addition to disabling the FTP service, disabling the SLBL service will reduce the exposure to this vulnerability because it could prevent the execution of content of the malicious SLBL database file.



The only method to disable SLBL is by using the GUI. Navigate to Monitor &gt;  Spam Quarantine and click the Edit Setting button under the End-User Safelist/Blocklist (Spam Quarantine) area. In the Edit window, uncheck the           Enable End User Safelist/Blocklist Feature check-box and click Submit.</Description>
      </Remediation>
    </Remediations>
    <References>
      <Reference Type="Self">
        <URL>http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20140319-asyncos</URL>
        <Description>Cisco AsyncOS Software Code Execution Vulnerability</Description>
      </Reference>
    </References>
  </Vulnerability>
</cvrfdoc>