<?xml version="1.0" encoding="UTF-8"?>
<cvrfdoc xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.icasi.org/CVRF/schema/cvrf/1.1">
  <DocumentTitle>Cisco IOS Software Session Initiation Protocol Denial of Service Vulnerability</DocumentTitle>
  <DocumentType>Cisco Security Advisory</DocumentType>
  <DocumentPublisher Type="Vendor">
    <ContactDetails>Emergency Support:
+1 877 228 7302 (toll-free within North America)
+1 408 525 6532 (International direct-dial)
Non-emergency Support:
Email: psirt@cisco.com
Support requests that are received via e-mail are typically acknowledged within 48 hours.</ContactDetails>
    <IssuingAuthority>Cisco product security incident response is the responsibility of the Cisco Product Security Incident Response Team (PSIRT). The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of security vulnerability information that is related to Cisco products and networks. The on-call Cisco PSIRT works 24x7 with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security issues with Cisco products and networks.
More information can be found in Cisco Security Vulnerability Policy available at http://www.cisco.com/web/about/security/psirt/security_vulnerability_policy.html</IssuingAuthority>
  </DocumentPublisher>
  <DocumentTracking>
    <Identification>
      <ID>cisco-sa-20140326-sip</ID>
    </Identification>
    <Status>Final</Status>
    <Version>1.1</Version>
    <RevisionHistory>
      <Revision>
        <Number>1.0</Number>
        <Date>2014-03-26T15:24:33</Date>
        <Description>Initial public release.</Description>
      </Revision>
      <Revision>
        <Number>1.1</Number>
        <Date>2014-03-31T13:46:38</Date>
        <Description>Added Cisco IOS XE Release 3.10.0aS as an affected release.</Description>
      </Revision>
    </RevisionHistory>
    <InitialReleaseDate>2014-03-26T16:00:00</InitialReleaseDate>
    <CurrentReleaseDate>2014-03-31T13:46:38</CurrentReleaseDate>
    <Generator>
      <Engine>TVCE</Engine>
    </Generator>
  </DocumentTracking>
  <DocumentNotes>
    <Note Title="Summary" Type="General" Ordinal="1">A vulnerability in the Session Initiation Protocol (SIP) implementation in Cisco IOS Software and Cisco IOS XE Software could allow an unauthenticated, remote attacker to cause a reload of an affected device. To exploit this vulnerability, affected devices must be configured to process SIP messages. Limited Cisco IOS Software and Cisco IOS XE Software releases are affected.



Cisco has released software updates that address this vulnerability. 



There are no workarounds for devices that must run SIP; however, mitigations are available to limit exposure to this vulnerability.



This advisory is available at the following link:

http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20140326-sip["http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20140326-sip"]



Note: The March 26, 2014, Cisco IOS Software Security Advisory bundled publication includes six Cisco Security Advisories. All advisories address vulnerabilities in Cisco IOS Software. Each Cisco IOS Software Security Advisory lists the Cisco IOS Software releases that correct the vulnerability or vulnerabilities detailed in the advisory as well as the Cisco IOS Software releases that correct all Cisco IOS Software vulnerabilities in the March 2014 bundled publication. 

Individual publication links are in Cisco Event Response: Semiannual Cisco IOS Software Security Advisory Bundled Publication at the following link: 

http://www.cisco.com/web/about/security/intelligence/Cisco_ERP_mar14.html["http://www.cisco.com/web/about/security/intelligence/Cisco_ERP_mar14.html"]
</Note>
  </DocumentNotes>
  <DocumentReferences>
    <Reference Type="Self">
      <URL>http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20140326-sip</URL>
      <Description>Cisco IOS Software Session Initiation Protocol Denial of Service Vulnerability</Description>
    </Reference>
    <Reference>
      <URL>http://tools.cisco.com/security/center/content/CiscoSecurityBundle/cisco-sa-20140326-bundle</URL>
      <Description>Summary of Semiannual Cisco IOS Software Security Advisory Bundled Publication, March 26, 2014</Description>
    </Reference>
    <Reference>
      <URL>http://tools.cisco.com/security/center/viewAlert.x?alertId=33344</URL>
      <Description>Cisco IOS Software and Cisco IOS XE Software Session Initiation Protocol Denial of Service Vulnerability</Description>
    </Reference>
    <Reference>
      <URL>http://tools.cisco.com/security/center/viewAMBAlert.x?alertId=32537</URL>
      <Description>Identifying and Mitigating Exploitation of the Cisco IOS Software Session Initiation Protocol Denial of Service Vulnerability</Description>
    </Reference>
    <Reference>
      <URL>http://tools.cisco.com/security/center/content/CiscoSecurityBundle/cisco-sa-20140326-bundle</URL>
      <Description>Summary of Semiannual Cisco IOS Software Security Advisory Bundled Publication, March 26, 2014</Description>
    </Reference>
    <Reference>
      <URL>http://tools.cisco.com/security/center/viewAlert.x?alertId=33344</URL>
      <Description>Cisco IOS Software and Cisco IOS XE Software Session Initiation Protocol Denial of Service Vulnerability</Description>
    </Reference>
    <Reference>
      <URL>http://tools.cisco.com/security/center/viewAMBAlert.x?alertId=32537</URL>
      <Description>Identifying and Mitigating Exploitation of the Cisco IOS Software Session Initiation Protocol Denial of Service Vulnerability</Description>
    </Reference>
  </DocumentReferences>
  <ProductTree xmlns="http://www.icasi.org/CVRF/schema/prod/1.1">
    <FullProductName ProductID="CVRFPID-187412">Cisco IOS 15.3(3)M</FullProductName>
    <FullProductName ProductID="CVRFPID-193284">Cisco IOS 15.3(3)M1</FullProductName>
    <FullProductName ProductID="CVRFPID-117783">Cisco IOS 15.3(3)S</FullProductName>
    <FullProductName ProductID="CVRFPID-193406">Cisco IOS 15.3(3)S1</FullProductName>
    <FullProductName ProductID="CVRFPID-198123">Cisco IOS XE Software 3.10S 3.10.0S</FullProductName>
    <FullProductName ProductID="CVRFPID-198124">Cisco IOS XE Software 3.10S 3.10.1S</FullProductName>
    <FullProductName ProductID="CVRFPID-213642">Cisco IOS XE Software 3.10S 3.10.1xbS</FullProductName>
  </ProductTree>
  <Vulnerability Ordinal="1" xmlns="http://www.icasi.org/CVRF/schema/vuln/1.1">
    <Title>Cisco IOS Software and Cisco IOS XE Software Session Initiation Protocol Denial of Service Vulnerability</Title>
    <ID SystemName="Cisco Bug ID">CSCug45898</ID>
    <Notes>
      <Note Title="Summary" Type="Summary" Ordinal="1">A vulnerability in the SIP functionality of Cisco IOS Software and Cisco IOS XE Software could allow an unauthenticated, remote attacker to trigger a device reload.



The vulnerability is due to incorrect processing of specific SIP messages. An attacker could exploit this vulnerability by sending specific SIP messages, which may be considered well formed or crafted to the SIP gateway. An exploit could allow the attacker to trigger a device reload.</Note>
      <Note Title="Cisco Bug IDs" Type="Other" Ordinal="3">CSCug45898</Note>
    </Notes>
    <CVE>CVE-2014-2106</CVE>
    <ProductStatuses>
      <Status Type="Known Affected">
        <ProductID>CVRFPID-117783</ProductID>
        <ProductID>CVRFPID-187412</ProductID>
        <ProductID>CVRFPID-193284</ProductID>
        <ProductID>CVRFPID-193406</ProductID>
        <ProductID>CVRFPID-198123</ProductID>
        <ProductID>CVRFPID-198124</ProductID>
        <ProductID>CVRFPID-213642</ProductID>
      </Status>
    </ProductStatuses>
    <CVSSScoreSets>
      <ScoreSet>
        <BaseScore>7.8</BaseScore>
        <TemporalScore>6.4</TemporalScore>
        <Vector>AV:N/AC:L/Au:N/C:N/I:N/A:C/E:F/RL:OF/RC:C</Vector>
      </ScoreSet>
    </CVSSScoreSets>
    <Remediations>
      <Remediation Type="Workaround">
        <Description>If the affected Cisco IOS device requires SIP for VoIP services, SIP cannot be disabled, and no workarounds are available. Users are advised to apply mitigation techniques to help limit exposure to the vulnerability. Mitigation consists of allowing only legitimate devices to connect to affected devices. To increase effectiveness, the mitigation must be coupled with anti-spoofing measures on the network edge. This action is required because SIP can use UDP as the transport protocol.



Additional mitigations that can be deployed on Cisco devices within the network are available in the companion document Identifying and Mitigating Exploitation of the Cisco IOS Software Session Initiation Protocol Denial of Service Vulnerability, which is available at the following link:

http://tools.cisco.com/security/center/viewAMBAlert.x?alertId=32537["http://tools.cisco.com/security/center/viewAMBAlert.x?alertId=32537"]
Disabling SIP Listening Ports
For devices that do not require SIP to be enabled, the simplest and most effective workaround is to disable SIP processing on the device. Some releases of Cisco IOS Software allow administrators to disable SIP with the following commands:

sip-ua
 no transport udp
 no transport tcp
 no transport tcp tls

Warning: When applying this workaround to devices that are processing Media Gateway Control Protocol (MGCP) or H.323 calls, the device will not stop SIP processing while active calls are being processed. Under these circumstances, this workaround should be implemented during a maintenance window when active calls can be stopped briefly.



The show udp connections, show tcp brief all, and show control-plane host open-ports commands can be used to confirm that the SIP UDP and TCP ports are closed after applying this workaround.



Depending on the Cisco IOS Software release in use, when SIP is disabled the output from the show ip sockets command may still show the SIP ports open, but sending traffic to them will cause the SIP process to display the following message:

*Nov 2 11:36:47.691: sip_udp_sock_process_read: SIP UDP Listener is DISABLED

Control Plane Policing
For devices that need to offer SIP services, it is possible to use Control Plane Policing (CoPP) to block SIP traffic to the device from untrusted sources. Cisco IOS Releases 12.0S, 12.2SX, 12.2S, 12.3T, 12.4, and 12.4T support the CoPP feature. CoPP may be configured on a device to protect the management and control planes to minimize the risk and effectiveness of direct infrastructure attacks by explicitly permitting only authorized traffic sent to infrastructure devices in accordance with existing security policies and configurations. The following example can be adapted to specific network configurations:

!? The 192.168.1.0/24 network and the 172.16.1.1 host are trusted.
!? Everything else is not trusted. The following access list is used
!? to determine what traffic needs to be dropped by a control plane
!? policy (the CoPP feature): if the access list matches (permit)
!? then traffic will be dropped and if the access list does not
!? match (deny) then traffic will be processed by the router.

access-list 100 deny udp 192.168.1.0 0.0.0.255 any eq 5060
access-list 100 deny tcp 192.168.1.0 0.0.0.255 any eq 5060
access-list 100 deny tcp 192.168.1.0 0.0.0.255 any eq 5061
access-list 100 deny udp host 172.16.1.1 any eq 5060
access-list 100 deny tcp host 172.16.1.1 any eq 5060
access-list 100 deny tcp host 172.16.1.1 any eq 5061
access-list 100 permit udp any any eq 5060
access-list 100 permit tcp any any eq 5060
access-list 100 permit tcp any any eq 5061

!? Permit (police or drop)/deny (allow) all other Layer3 and Layer4
!? traffic in accordance with existing security policies and
!? configurations for traffic that is authorized to be sent
!? to infrastructure devices.
!? Create a class map for traffic to be policed by
!? the CoPP feature.

class-map match-all drop-sip-class
  match access-group 100

!? Create a policy map that will be applied to the
!? control plane of the device.

policy-map control-plane-policy
 class drop-sip-class
  drop

!? Apply the policy map to the control plane of the
!? device.

control-plane
 service-policy input control-plane-policy

Note: Because SIP can use UDP as a transport protocol, it is possible to spoof the source address of an IP packet, which may bypass access control lists that permit communication to these ports from trusted IP addresses. Additional information about Unicast Reverse Path Forwarding is at http://www.cisco.com/web/about/security/intelligence/unicast-rpf.html["http://www.cisco.com/web/about/security/intelligence/unicast-rpf.html"]



In the preceding CoPP example, the access control entries that match the potential exploit packets with the permit action cause these packets to be discarded by the policy map drop function, while packets that match the deny action (not shown) are not affected by the policy map drop function. Additional information about the configuration and use of the CoPP feature is at http://www.cisco.com/web/about/security/intelligence/coppwp_gs.html["http://www.cisco.com/web/about/security/intelligence/coppwp_gs.html"] and http://www.cisco.com/en/US/docs/ios/12_3t/12_3t4/feature/guide/gtrtlimt.html["http://www.cisco.com/en/US/docs/ios/12_3t/12_3t4/feature/guide/gtrtlimt.html"].</Description>
      </Remediation>
    </Remediations>
    <References>
      <Reference Type="Self">
        <URL>http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20140326-sip</URL>
        <Description>Cisco IOS Software Session Initiation Protocol Denial of Service Vulnerability</Description>
      </Reference>
    </References>
  </Vulnerability>
</cvrfdoc>