<?xml version="1.0" encoding="UTF-8"?>
<cvrfdoc xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.icasi.org/CVRF/schema/cvrf/1.1">
  <DocumentTitle>Common UNIX Printing System IPP Tags Memory Corruption Vulnerability</DocumentTitle>
  <DocumentType>Cisco Security Advisory</DocumentType>
  <DocumentPublisher Type="Vendor">
    <ContactDetails>Emergency Support:
+1 877 228 7302 (toll-free within North America)
+1 408 525 6532 (International direct-dial)
Non-emergency Support:
Email: psirt@cisco.com
Support requests that are received via e-mail are typically acknowledged within 48 hours.</ContactDetails>
    <IssuingAuthority>Cisco product security incident response is the responsibility of the Cisco Product Security Incident Response Team (PSIRT). The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of security vulnerability information that is related to Cisco products and networks. The on-call Cisco PSIRT works 24x7 with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security issues with Cisco products and networks.
More information can be found in Cisco Security Vulnerability Policy available at http://www.cisco.com/web/about/security/psirt/security_vulnerability_policy.html</IssuingAuthority>
  </DocumentPublisher>
  <DocumentTracking>
    <Identification>
      <ID>Cisco-SA-20071031-CVE-2007-4351</ID>
    </Identification>
    <Status>Final</Status>
    <Version>11.0</Version>
    <RevisionHistory>
      <Revision>
        <Number>11.0</Number>
        <Date>2012-07-14T19:36:06</Date>
        <Description>No Description Available</Description>
      </Revision>
    </RevisionHistory>
    <InitialReleaseDate>2007-10-31T17:40:08</InitialReleaseDate>
    <CurrentReleaseDate>2012-07-14T19:36:06</CurrentReleaseDate>
    <Generator>
      <Engine>TVCE</Engine>
    </Generator>
  </DocumentTracking>
  <DocumentNotes>
    <Note Title="Summary" Type="General" Ordinal="1">The Common UNIX Printing System (CUPS) versions 1.3.3 and prior contain a vulnerability that can allow an unauthenticated, remote attacker to create a denial of service (DoS) condition or execute arbitrary code with the privileges of the user.

The vulnerability exists in the ippReadIO() function when processing Internet Printing Protocol (IPP) tags.  The function causes an off-by-one error when allocating space.  An unauthenticated, remote attacker could send a request with crafted tags to overwrite one byte on the stack with a zero.  The attacker could crash the daemon or possibly execute arbitrary code.

The vendor has confirmed this vulnerability in release notes and released an updated version.





The vulnerability requires the attacker to connect to the IPP TCP port to perform an attack.  However, the default configuration of CUPS does not allow remote hosts to connect to this port.  This configuration should mitigate the potential for this attack.  IT departments that deploy and use CUPS without changing the default configuration may not be at risk.

The severity of the impact will vary depending on the system on which CUPS is deployed.  If this system is used for multiple services, a DoS condition could cause other services besides the CUPS service to crash, which may affect other users and departments.  

If code execution is accomplished, it will most likely be in the context of the CUPS user.  This user probably has limited privileges.
</Note>
  </DocumentNotes>
  <DocumentReferences>
    <Reference Type="Self">
      <URL>http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-SA-20071031-CVE-2007-4351</URL>
      <Description>Common UNIX Printing System IPP Tags Memory Corruption Vulnerability</Description>
    </Reference>
  </DocumentReferences>
  <ProductTree xmlns="http://www.icasi.org/CVRF/schema/prod/1.1">
    <FullProductName ProductID="CVRFPID-61482">Cisco Wide Area Application Services (WAAS) 4.0 Base</FullProductName>
    <FullProductName ProductID="CVRFPID-69137">Cisco Wide Area Application Services (WAAS) 4.0.7</FullProductName>
    <FullProductName ProductID="CVRFPID-69139">Cisco Wide Area Application Services (WAAS) 4.0.7.46</FullProductName>
    <FullProductName ProductID="CVRFPID-69138">Cisco Wide Area Application Services (WAAS) 4.0.9</FullProductName>
    <FullProductName ProductID="CVRFPID-69140">Cisco Wide Area Application Services (WAAS) 4.0.9.10</FullProductName>
    <FullProductName ProductID="CVRFPID-81233">Cisco Wide Area Application Services (WAAS) 4.0.11.34</FullProductName>
    <FullProductName ProductID="CVRFPID-81234">Cisco Wide Area Application Services (WAAS) 4.0.13.23</FullProductName>
    <FullProductName ProductID="CVRFPID-81235">Cisco Wide Area Application Services (WAAS) 4.0.17.14</FullProductName>
  </ProductTree>
  <Vulnerability Ordinal="1" xmlns="http://www.icasi.org/CVRF/schema/vuln/1.1">
    <Title>Common UNIX Printing System IPP Tags Memory Corruption Vulnerability</Title>
    <CVE>CVE-2007-4351</CVE>
    <ProductStatuses>
      <Status Type="Known Affected">
        <ProductID>CVRFPID-61482</ProductID>
        <ProductID>CVRFPID-69137</ProductID>
        <ProductID>CVRFPID-69138</ProductID>
        <ProductID>CVRFPID-69139</ProductID>
        <ProductID>CVRFPID-69140</ProductID>
        <ProductID>CVRFPID-81233</ProductID>
        <ProductID>CVRFPID-81234</ProductID>
        <ProductID>CVRFPID-81235</ProductID>
      </Status>
    </ProductStatuses>
    <CVSSScoreSets>
      <ScoreSet>
        <BaseScore>6.4</BaseScore>
        <TemporalScore>4.7</TemporalScore>
        <Vector>AV:N/AC:L/Au:N/C:N/I:P/A:P/E:U/RL:OF/RC:C/CDP:N/TD:N/CR:ND/IR:ND/AR:ND</Vector>
      </ScoreSet>
    </CVSSScoreSets>
    <Remediations>
      <Remediation Type="Workaround">
        <Description>Administrators are advised to apply the appropriate update.

Administrators are advised to restrict access to trusted users.

The Cisco Applied Intelligence team has created the following companion document to guide administrators in identifying and mitigating attempts to exploit this vulnerability prior to applying updated software: Identifying and Mitigating Exploitation of the Wide Area Application Services Common UNIX Printing System Vulnerability["http://www.cisco.com/en/US/products/products_applied_mitigation_bulletin09186a00809a1f19.html"] 
</Description>
      </Remediation>
    </Remediations>
    <References>
      <Reference Type="Self">
        <URL>http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-SA-20071031-CVE-2007-4351</URL>
        <Description>Common UNIX Printing System IPP Tags Memory Corruption Vulnerability</Description>
      </Reference>
    </References>
  </Vulnerability>
</cvrfdoc>